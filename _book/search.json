[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Skrypt do kursy Analiza danych biologicznych i prezentacja wykresów",
    "section": "",
    "text": "Wstęp\nAnaliza danych biologicznych i prezentacja wyników"
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "This is a book created from markdown and executable code.\nSee Knuth (1984) for additional discussion of literate programming.\n\n1 + 1\n\n[1] 2\n\n\n\n\n\n\nKnuth, Donald E. 1984. “Literate Programming.” Comput. J. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97."
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "2  Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Odkrywać! Ujawniać! Objaśniać! Zbiór esejów o sztuce prezentowania danych, Przemysław Biecek\nFundamentals of Data Visualization, Claus O. Wilke, https://clauswilke.com/dataviz/\nTen Simple Rules for Better Figures Rougier NP, Droettboom M, Bourne PE (2014) PLoS Comput Biol 10(9): e1003833. https://doi.org/10.1371/journal.pcbi.1003833\nThe misuse of colour in science communication. Crameri, F., Shephard, G.E. & Heron, P.J. Nat Commun 11, 5444 (2020). https://doi.org/10.1038/s41467-020-19160-7\nBeyond Bar and Line Graphs: Time for a New Data Presentation Paradigm. Weissgerber TL, Milic NM, Winham SJ, Garovic VD (2015) PLoS Biol 13(4): e1002128. https://doi.org/10.1371/journal.pbio.1002128\nVisualization of Biomedical Data, Seán I. O’Donoghue, Benedetta Frida Baldi, Susan J. Clark, Aaron E. Darling, James M. Hogan, Sandeep Kaur, Lena Maier-Hein, Davis J. McCarthy, William J. Moore, Esther Stenau, Jason R. Swedlow, Jenny Vuong, James B. Procter, Annual Review of Biomedical Data Science 2018 1:1, 275-304\nSave the Pies for Dessert, Stephen Few, Perceptual Edge, Visual Business Intelligence Newsletter, August 2007\nWhy rainbow colour scales can be misleading, Ed Hawkins, http://www.climate-lab-book.ac.uk/2016/why-rainbow-colour-scales-can-be-misleading/\nData Visualization in the Neurosciences: Overcoming the Curse of Dimensionality, Elena A.Allen, Erik B.Erhardt, Vince D.Calhoun\nWhy scientists need to be better at data visualization, Betsy Mason, https://knowablemagazine.org/article/mind/2019/science-data-visualization\nEnd of the Rainbow? New Map Scale Is More Readable by People Who Are Color Blind, Betsy Mason, https://www.scientificamerican.com/article/end-of-the-rainbow-new-map-scale-is-more-readable-by-people-who-are-color-blind/\nReal Chart Rules to Follow, Nathan Yau, https://flowingdata.com/2015/08/11/real-chart-rules-to-follow/\nBeyond Memorability: Visualization Recognition and Recall Michelle A. Borkin, Member, IEEE, Zoya Bylinskii, Nam Wook Kim, Constance May Bainbridge, Chelsea S. Yeh, Daniel Borkin, Hanspeter Pfister, Senior Member, IEEE, and Aude Oliva\nUseful Junk? The Effects of Visual Embellishment on Comprehension and Memorability of Charts Scott Bateman, Regan L. Mandryk, Carl Gutwin, Aaron Genest, David McDine, Christopher Brooks\nWhy you sometimes need to break the rules in data viz, Rosamund Pearce, https://medium.economist.com/why-you-sometimes-need-to-break-the-rules-in-data-viz-4d8ece284919"
  },
  {
    "objectID": "histogram.html#jak-narysować-histogram-w-r",
    "href": "histogram.html#jak-narysować-histogram-w-r",
    "title": "2  Histogram",
    "section": "2.1 Jak narysować histogram w R?",
    "text": "2.1 Jak narysować histogram w R?\nWczytaj dane do R korzystając z Import Dataset lub odpowiedniej funkcji. Więcej informacji w Jak wczytać dane do R\n\n2.1.1 Base R\nDo narysowania histogramu wykorzystaj funkcję hist. Jako pierwszy argument podaj odpowiednią kolumnę z wczytanej tabeli korzystając z $ np. nazwa_tabeli$nazwa_kolumny. Dodatkowo możesz użyć argumentu breaks do podania oczekiwanej liczby przedziałów histogramu. Jako przykładu użyję losowo wygenerowanych danych.\n\n# wczytanie danych\ndata_hist &lt;- read.table('data/data_test.txt')\n\n# histogram\nhist(data_hist$x)\n\n\n\n# histogram z wybraną liczbą przedziałów\nhist(data_hist$x, breaks = 50)\n\n\n\n\n\n\n2.1.2 ggplot2\nDo narysowania histogramu wykorzystaj funkcje ggplot i geom_histogram\nW funkcji ggplot podaj nazwę tabeli i nazwę kolumny z danymi: ggplot(nazwa_tabeli, aes(x = nazwa_kolumny)). Potem dodaj do geom_histogram(). Możesz dodatkowo ustawić szerokość przedziału przy pomocy argumentu binwidth\n\n# wczytaj bibliotekę ggplot2\nlibrary(ggplot2)\n\n# histogram\nggplot(data_hist, aes(x = x)) + \n  geom_histogram()\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n# histogram z wybraną szerokością przedziału\nggplot(data_hist, aes(x = x)) + \n  geom_histogram(binwidth = 0.1)+\n  theme_bw() # białe tło"
  },
  {
    "objectID": "histogram.html#jak-narysować-histogram-w-excel",
    "href": "histogram.html#jak-narysować-histogram-w-excel",
    "title": "2  Histogram",
    "section": "2.2 Jak narysować histogram w Excel?",
    "text": "2.2 Jak narysować histogram w Excel?\nAby narysować histogram w programie Excel zaznacz dane w arkuszu, a następnie wybierz wykres histogram z zakładki Insert.\n\n\n\n\n\nOtrzymany wykres powinien wyglądać podobnie do przykładu poniżej. Domyślnie oś X zawiera wszystkie używane przedziały, co powoduje, że jest dość nieczytelna.\n\n\n\n\n\nAby zmienić szerokość przedziałów wejdź w ustawienia osi X i zmień Bin width na wybraną wartość, możesz też ustawić wybraną liczbę przedziałów, wtedy ich szerokość zostanie dobrana automatycznie."
  },
  {
    "objectID": "index.html#wstęp",
    "href": "index.html#wstęp",
    "title": "Skrypt do kursy Analiza danych biologicznych i prezentacja wykresów",
    "section": "Wstęp",
    "text": "Wstęp\nAnaliza danych biologicznych i prezentacja wyników\nSkrypt zawiera opis przygotowania wykresów w programie R i Excel wraz z przykładami."
  },
  {
    "objectID": "wczytanie_danych.html#wczytanie-danych-do-r",
    "href": "wczytanie_danych.html#wczytanie-danych-do-r",
    "title": "2  Wczytanie danych",
    "section": "2.1 Wczytanie danych do R",
    "text": "2.1 Wczytanie danych do R\nDo R można wczytać dane zapisane w formacie tekstowym txt, csv itp. oraz w formacie excel xlsx (wymaga zainstalowania dodatkowego pakietu readxl).\nWczytanie danych do R ułatwia obecna w Rstudio funkcja Import Dataset\n\n\n\n\n\nPo wybraniu opcji From text (base) i pliku tekstowego powinno otworzyć się poniższe okno dialogowe\n\n\n\n\n\nPo ustawieniu wszytskich parametrów takich jak obecność nazw kolumn i separatory można wczytać dane (Import). Dane pojawią się w środowisku R (zakładka Environment). W oknie konsoli pojawi się też kod użyty do wczytania danych, który można skopiować i zapisać w skrypcie do wykorzystania w przyszłości. Kliknięcie na nazwę wczytanej tabeli w zakładce Environment otworzy podgląd danych, który można sortować i filtrować, ale nie jest możliwa edycja danych."
  },
  {
    "objectID": "wczytanie_danych.html#jak-wczytać-dane-do-r",
    "href": "wczytanie_danych.html#jak-wczytać-dane-do-r",
    "title": "1  Wczytanie danych",
    "section": "1.1 Jak wczytać dane do R?",
    "text": "1.1 Jak wczytać dane do R?\nDo R można wczytać dane zapisane w formacie tekstowym txt, csv itp. oraz w formacie excel xlsx (wymaga zainstalowania dodatkowego pakietu readxl).\nWczytanie danych do R ułatwia obecna w Rstudio funkcja Import Dataset (Zakładka Environment).\n\n\n\n\n\nPo wybraniu opcji From text (base) i pliku tekstowego powinno otworzyć się poniższe okno dialogowe.\n\n\n\n\n\nPo ustawieniu wszytskich parametrów takich jak obecność nazw kolumn i separatory można wczytać dane (Import). Dane pojawią się w środowisku R (zakładka Environment). W oknie konsoli pojawi się też kod użyty do wczytania danych, który można skopiować i zapisać w skrypcie do wykorzystania w przyszłości. Kliknięcie na nazwę wczytanej tabeli w zakładce Environment otworzy podgląd danych, który można sortować i filtrować, ale nie jest możliwa edycja danych.\nJeżeli chcesz dowiedzieć się więcej na temat pracy z danymi tabelarycznymi w R polecam pakiety dplyr i tidyr."
  },
  {
    "objectID": "boxplot.html#jak-narysować-boxplot-w-r",
    "href": "boxplot.html#jak-narysować-boxplot-w-r",
    "title": "3  Boxplot",
    "section": "3.1 Jak narysować boxplot w R?",
    "text": "3.1 Jak narysować boxplot w R?\nWczytaj dane do R korzystając z Import Dataset lub odpowiedniej funkcji. Więcej informacji w Jak wczytać dane do R\n\n3.1.1 Base R\nDo narysowania wykresu pudełkowego wykorzystaj funckję boxplot. Możesz po przecinku podać kolejne kolumny danych zawierające dane do przedstawienia na wykresie korzystając z $ np. nazwa_tabeli$nazwa_kolumny albo skorzystać z formuły: nazwa_tabeli$kolumna_z_danymi_liczbowymi ~ nazwa_tabeli$kolumna_z_grupami.\n\ndata_box &lt;- read.table('data/data_test.txt')\n\nboxplot(data_box$x)\n\n\n\nboxplot(data_box$x ~ data_box$rozklad)\n\n\n\n\n\n\n3.1.2 ggplot2\nDo narysowania histogramu wykorzystaj funkcje ggplot i geom_boxplot\nW funkcji ggplot podaj nazwę tabeli, nazwę kolumny z danymi liczbowymi i nazwę kolumny z grupami: ggplot(nazwa_tabeli, aes(x = nazwa_kolumny_grupy, y = nazwa_kolumny_liczby)). Potem dodaj do niej geom_boxplot().\n\n# wczytaj bibliotekę ggplot2\nlibrary(ggplot2)\n\nggplot(data_box, aes(x = rozklad, y = x))+\n  geom_boxplot()\n\n\n\n\nWykres pudełkowy można połączyć z wykresem wiolinowym pokazującym kształt rozkładu używając funkcji geom_violin lub dodać do niego wszystkie obserwacje jako punkty używając geom_jitter. Polecam sprawdzić dodatkowy pakiet ggbeeswarm, który zawiera inne funckje umożliwiające dodanie obserwacji do wykresu.\n\nggplot(data_box, aes(x = rozklad, y = x))+\n  geom_boxplot(width = 0.2)+ # width zmienia szerokość pudełka\n  geom_violin(alpha = 0)+ # alpha = 0 violin będzie pusty w środku\n  theme_classic() # białe tło, bez linii pomocniczych\n\n\n\nggplot(data_box, aes(x = rozklad, y = x))+\n  geom_boxplot(width = 0.2, fill = 'lightgreen')+ # width zmienia szerokość pudełka\n  geom_violin(alpha = 0)+ # alpha = 0 violin będzie pusty w środku\n  theme_classic()+ # białe tło, bez linii pomocniczych\n  geom_jitter(alpha = 0.25, width = 0.1)"
  },
  {
    "objectID": "wczytanie_danych.html#jak-wczytać-dane-tekstowe-do-excel",
    "href": "wczytanie_danych.html#jak-wczytać-dane-tekstowe-do-excel",
    "title": "1  Wczytanie danych",
    "section": "1.2 Jak wczytać dane tekstowe do Excel?",
    "text": "1.2 Jak wczytać dane tekstowe do Excel?\n\n1.2.1 Podział danych na kolumny\nDane tekstowe można do “wkleić” do programu Excel. Zdarza się, że nie podzielą się one automatycznie na kolumny i będą wyglądały tak:\n\n\n\n\n\nAby ręcznie podzielić dane na kolumny wybierz opcję Text to Columns z zakładki Data.\n\n\n\n\n\nNastępnie wybierz opcję Delimited\n\n\n\n\n\nOraz właściwy seperator, w przykładzie jest to spacja. Zdarza się, że nagłówki kolumn mogą zostać przesunięte i będzie je trzeba później poprawić. Na koniec naciśnij Finish.\n\n\n\n\n\nPo wczytaniu danych upewnij się, że kolumny mają właściwy typa danych to jest liczby powinny mieć format number, a text lub date. Jeżeli liczby są zapisane z kropką jako separatorem dzisiętnym np. 10.45, może pomóc zmiana wszystkich . na , .\n\n\n1.2.2 Tabela przestawna\nW zależności od źródła danych mogą być one uporządkowane w różny sposób. Generalnie wyróżnia się dwa sposoby ułożenia danych w tabeli: szeroki i wąski. Typ szeroki jest łatwiejszy do pracy w Excel, tryb wąski za to ułatwia wizualizację danych w R. Oba programy zawierają funkcje pozwalające na zmianą typu danych : Excel - tabela przestawna (pivot table), R - pakiet tidyr i funckje pivot_longer/pivot_wider.\nPrzykład danych w postaci wąskiej. W kolumnach znajdują się kolejne zmienne, w wierszach obserwacje.\n\n\n\nroślina\ngen\nwysokość\nliczba liści\n\n\n\n\n1\nA\n20\n5\n\n\n2\nA\n25\n7\n\n\n3\nB\n12\n2\n\n\n4\nB\n16\n3\n\n\n5\nC\n32\n6\n\n\n6\nC\n33\n5\n\n\n\nPrzykład danych w postaci szerokiej.\n\n\n\n\n\n\n\n\n\n\n\nA wysokość\nB wysokość\nC wysokość\nA liczba liści\nB liczba liści\nC liczba liści\n\n\n\n\n20\n12\n32\n5\n2\n6\n\n\n25\n16\n33\n7\n3\n5\n\n\n\nDo zmiany danych z wąskich na szerokie zaznacz wybrane kolumny i wybierz funkcję pivot table z zakładki Insert.\n\n\n\n\n\nZostaniesz przeniesiony do nowego arkusza. W oknie po lewej stronie możesz wybrać zmienne, które staną się nagłówkami kolumn (Columns), wierszy (Rows) i wartościami w tabeli (Values). Wystarczy, że przeciągniesz nazwy kolumn z górnego okienka do dolnych.\nJeżeli nie wybierzesz żadnej kolumny do okienka Rows otrzymasz przekształcone dane (np. zostanie policzona średnia dla każdej nowej kolumny). Aby tego uniknąć Twoje dane muszą zawierać unikalny identyfikator dla każdego nowego rzędu np. kolumnę z kolejnymi liczbami od 1 do … .\n\n\n\n\n\nPowinieneś otrzymać tabelę podobną do tej w przykładzie."
  },
  {
    "objectID": "boxplot.html#jak-narysować-boxplot-w-excel",
    "href": "boxplot.html#jak-narysować-boxplot-w-excel",
    "title": "3  Boxplot",
    "section": "3.2 Jak narysować boxplot w Excel?",
    "text": "3.2 Jak narysować boxplot w Excel?\nAby narysować boxplot w programie Excel zaznacz dane w arkuszu, a następnie wybierz wykres boxplot z zakładki Insert. Jeżeli chcesz narysować więcej niż jeden boxplot zaznacz kilka kolumn.\n\n\n\n\n\nOtrzymany wykres powinien wyglądać podobnie do przykładu poniżej. Domyślnie wykres nie ma legendy, która przypisywałaby dany kolor do wybranych kolumn, brak też podpisów na osi X. Wykres oprócz mediany i kwartyli pokazuje także średnią oznaczoną symbolem ‘x’."
  },
  {
    "objectID": "barplot.html#jak-narysować-wykres-słupkowy-w-r",
    "href": "barplot.html#jak-narysować-wykres-słupkowy-w-r",
    "title": "4  Wykres słupkowy",
    "section": "4.1 Jak narysować wykres słupkowy w R?",
    "text": "4.1 Jak narysować wykres słupkowy w R?\nWczytaj dane do R korzystając z Import Dataset lub odpowiedniej funkcji. Więcej informacji w Jak wczytać dane do R\n\n4.1.1 Base R\nDo przygotowanie wykresu słupkowego w R można wykorzystać dane pokazujące jak często występowała dana kategoria. Jako przykładu użyję danych dotyczących zwierząt przebywających w schronisku.\n\n# wczytanie danych csv\nanimal &lt;- read.csv('data/animal.csv')\n# head pokazuje pierwsze 6 wierszy z tabeli\nhead(animal)\n\n  X Impound.No Intake.Date Intake.Type Animal.Type Neutered.Status    Sex\n1 1 K12-000031      1/1/12       Stray         Dog          Spayed Female\n2 2 K12-000037      1/1/12       Stray         Dog          Intact Female\n3 3 K12-000108      1/1/12       Stray         Dog          Intact   Male\n4 4 K12-000125      1/1/12       Stray         Dog        Neutered   Male\n5 5 K12-000157      1/1/12       Stray         Dog        Neutered   Male\n6 6 K12-000286      1/1/12       Stray         Dog        Neutered   Male\n  Age.Intake       Condition                         Breed Aggressive\n1         10 Injured or Sick              Chihuahua Sh Mix          N\n2          3          Normal               Rat Terrier Mix          N\n3          2          Normal                  Pit Bull Mix          N\n4          0          Normal Labrador Retr & Border Collie          N\n5          3 Injured or Sick                Labrador Retr           N\n6          5          Normal               Yorkshire Terr           N\n  Independent Intelligent Loyal Social Good.with.Kids Max.Life.Expectancy\n1           N           Y     N      N              N                  18\n2           N           Y     N      Y              Y                  14\n3           N           N     Y      N              Y                  14\n4           Y           Y     Y      Y              Y                  12\n5           Y           Y     Y      Y              Y                  12\n6           N           N     Y      N              Y                  15\n  Max.Weight Dog.Group         Color Weight           Lab.Test Outcome.Date\n1          6       Toy   Tan & White    3.3 Heartworm Negative       1/7/12\n2         25   Terrier White & Brown    7.5        No Lab Test       1/3/12\n3         90   Terrier  Blue & White   74.0 Heartworm Negative      1/13/12\n4         79  Sporting White & Black   22.0        No Lab Test       1/8/12\n5         79  Sporting Black & White   54.0 Heartworm Negative       4/4/12\n6          7   Terrier  Silver & Tan    4.8 Heartworm Negative      1/10/12\n       Outcome.Type Days.Shelter\n1          Adoption            6\n2   Return to Owner            2\n3 Humane Euthanasia           12\n4          Adoption            7\n5          Adoption           94\n6   Return to Owner            9\n\n\nW powyższych danych można przygotować wykres słupkowy pokazujący liczebność kategorii w kolumnie Intake.Type lub Animal.Type\n\n# funkcja table zlicza częstość występowania każdej grupy\nanimal_type_tabela &lt;- table(animal$Animal.Type)\n# rysowanie wykresu\nbarplot(animal_type_tabela)\n\n\n\n\n\n\n4.1.2 ggplot2\nDo narysowania histogramu wykorzystaj funkcje ggplot i geom_bar albo geom_col. To, której funkcji użyjemy zależy od tego czy dane zostały wcześniej zliczone (geom_col) czy nie (geom_bar).\nDo zliczania danych zamiast funkcji table lepiej użyć funkcji count z pakietu dplyr.\n\n# wczytanie bibliotek\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# prostsza wersja - geom_bar()\nggplot(animal, aes(x = Animal.Type))+\n  geom_bar()\n\n\n\n# trudniejsza wersja count + geom_col\ntabela_animal_type &lt;- count(animal, Animal.Type)\nggplot(tabela_animal_type, aes(x = Animal.Type, y = n))+\n  geom_col()"
  },
  {
    "objectID": "barplot.html#jak-narysować-wykres-słupkowy-w-excel",
    "href": "barplot.html#jak-narysować-wykres-słupkowy-w-excel",
    "title": "4  Wykres słupkowy",
    "section": "4.2 Jak narysować wykres słupkowy w Excel?",
    "text": "4.2 Jak narysować wykres słupkowy w Excel?\nPodobnie jak w R pierwszym krokiem jest przygotowanie tabeli liczebności dla wybranej zmiennej. Można to zrobić przy pomocy tabeli przestawnej lub przy pomocy funkcji COUNTIF (pol. LICZ.JEŻELI).\n\n\n\n\n\nNastępnie należy zaznaczyć dane i wybrać wykres kolumnowy 2-D z zakładki Insert\n\n\n\n\n\nOtrzymany wykres powinien wyglądać podobnie do przykładu poniżej."
  },
  {
    "objectID": "scatterplot.html#jak-narysować-wykres-rozrzutu-w-r",
    "href": "scatterplot.html#jak-narysować-wykres-rozrzutu-w-r",
    "title": "5  Wykres rozrzutu",
    "section": "5.1 Jak narysować wykres rozrzutu w R?",
    "text": "5.1 Jak narysować wykres rozrzutu w R?\nWczytaj dane do R korzystając z Import Dataset lub odpowiedniej funkcji. Więcej informacji w Jak wczytać dane do R\n\n5.1.1 Base R\nDo narysowanie wykresu rozrzutu można użyć funkcji plot, w której jako dwa pierwsze argumenty należy podać kolumny tabeli z danymi np. plot(tabela$kolumna_1, tabela$kolumna_2). Jako przykładu użyję danych dotyczących wielkości i procentu GC genomów bakteryjnych.\n\n# wczytanie danych dotyczących wielkości genomów bakteryjnych\ngenomes &lt;- read.table('data/genomes.txt')\n\n# wykres zależności wielkości genomu od procenta par GC\nplot(genomes$size, genomes$GC)\n\n\n\n# dodanie koloru według środowiska życia i legendy\nplot(genomes$size, genomes$GC, col = factor(genomes$habitat, \n                                            levels = c(\"Aquatic\", \"Specialized\", \"Multiple\", \"Terrestrial\", \"Host-associated\", \"\")))\nlegend(10, 50, legend=c( \"Aquatic\", \"Specialized\", \"Multiple\", \"Terrestrial\", \"Host-associated\", \"\"),\n       col = palette()[1:6], cex = 0.8, pch = 21)\n\n\n\n\n\n\n5.1.2 ggplot2\nDo narysowania wykresu rozrzutu wykorzystaj funkcje ggplot i geom_point.\nW funkcji ggplot podaj nazwę tabeli i nazwę kolumn z danymi: ggplot(nazwa_tabeli, aes(x = nazwa_kolumny_1, y = nazwa_kolumny_2)). Potem dodaj geom_point(). W aes możesz też podać trzecią kolumnę, która pozwoli na pokolorowanie punktów według zmiennej jakościowej. Legenda zostanie utworzona automatycznie.\n\n# wczytanie biblioteki\nlibrary(ggplot2)\n# wykres zależności wielkości genomu od procenta GC\nggplot(genomes, aes(x = size, y = GC))+\n  geom_point()\n\n\n\n# ten sam wykres pokolorowany według środowiska życia\nggplot(genomes, aes(x = size, y = GC, color = habitat))+\n  geom_point()+\n  theme_bw()\n\n\n\n# zmiana skali koloru na Rcolorbrewer\nggplot(genomes, aes(x = size, y = GC, color = habitat))+\n  geom_point()+\n  theme_bw()+\n  scale_color_brewer(palette = 'Set1')\n\n\n\n\n\n\n5.1.3 Dodanie linii trendu\nAby do wykresu narysowanego przy pomocy pakietu ggplot2 dodać linię trendu wystarczy do wcześniejszego kodu dodać funkcję geom_smooth. Domyślnie linia trendu zostanie dopasowane przy pomocy algorytmu loess, można to zmienić na model liniowy przy pomocy argumentu model = 'lm'. Szary obszar wokół linii to 95% przedział ufności. W tej części jako przykładu używam danych dotyczących wzrostu.\n\n# wczytanie danych\ndata_trend &lt;- read.table('data/heights.txt')\n\nggplot(data_trend, aes(x = Husband, y = Wife))+\n  geom_point()+\n  geom_smooth(method = 'lm')+\n  theme_bw() # białe tło\n\n\n\n\nAby obliczyć parametry modeli liniowego (a i b) można wykorzystać funkcję lm.\n\nmodel &lt;- lm(Wife ~ Husband, data = data_trend)\n# wyświetl model, b - Intercept, a - Husband\nsummary(model)\n\n\nCall:\nlm(formula = Wife ~ Husband, data = data_trend)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-19.4685  -3.9208   0.8301   3.9538  11.1287 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 41.93015   10.66162   3.933 0.000161 ***\nHusband      0.69965    0.06106  11.458  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5.928 on 94 degrees of freedom\nMultiple R-squared:  0.5828,    Adjusted R-squared:  0.5783 \nF-statistic: 131.3 on 1 and 94 DF,  p-value: &lt; 2.2e-16"
  },
  {
    "objectID": "scatterplot.html#jak-narysować-wykres-rozrzutu-w-excel",
    "href": "scatterplot.html#jak-narysować-wykres-rozrzutu-w-excel",
    "title": "5  Wykres rozrzutu",
    "section": "5.2 Jak narysować wykres rozrzutu w Excel?",
    "text": "5.2 Jak narysować wykres rozrzutu w Excel?\nAby narysować wykres rozrzutu w programie Excel zaznacz dane w arkuszu, a następnie wybierz wykres scatter z zakładki Insert. Jeżeli chcesz, aby na wykresie znalazły się kropki w różnych kolorach zaznacz kilka kolumn.\n\n\n\n\n\nOtrzymany wykres powinien wyglądać podobnie do przykładu poniżej Domyślnie oś X i Y będą zaczynać się od 0. Dostosuj minimalną wartość osi, jeżeli twoje dane nie zawierają wartości 0. Przy bardzo dużej liczbie punktów wykres może stać się nieczytelny. Aby tego uniknąć zastosuj punkty puste w środku albo częściowo przezroczyste.\n\n\n\n\n\n\n5.2.1 Dodanie linii trendu\nDo wykresu rozrzutu można dodać linię trendu korzystając z opcji Trendline. W przykładzie wybiorę model liniowy (Linear).\n\n\n\n\n\nRównanie dla modelu liniowego można wyświetlić bezpośrednio na wykresie wybierając odpowiednią opcję\n\n\n\n\n\nPowinieneś otrzymać wykres, który wygląda podobnie do przykładu."
  },
  {
    "objectID": "line_plot.html#jak-narysować-wykres-liniowy-w-r",
    "href": "line_plot.html#jak-narysować-wykres-liniowy-w-r",
    "title": "6  Wykres liniowy",
    "section": "6.1 Jak narysować wykres liniowy w R?",
    "text": "6.1 Jak narysować wykres liniowy w R?\nWczytaj dane do R korzystając z Import Dataset lub odpowiedniej funkcji. Więcej informacji w Jak wczytać dane do R. Jako przykładu użyję danych dotyczących wzrostu kurczaków w zależności od rodzaju diety.\n\n6.1.1 Base R\nWykres liniowy, podobnie jak wykres rozrzutu można narysować przy pomocy funkcji plot, wystarczy dodać do niej argument type = 'l' lub type = 'b'. Niestety dodanie kilku linii w różnym kolorze wymaga użycia funkcji lines dla każdej nowej linii i ręcznego ustawienia legendy.\n\n# wczytanie danych\ndata_line &lt;- read.table('data/chick.txt') \n\nplot(x = data_line$Time[1:12], y = data_line$weight[1:12], type = 'b', col = 'red', \n     ylim = c(40, 280), xlab = 'Time', ylab = 'Weight') # zakres osi Y, nazwy osi X i Y\nlines(x = data_line$Time[13:24], y = data_line$weight[13:24], type = 'b', col = 'green3')\nlines(x = data_line$Time[25:36], y = data_line$weight[25:36], type = 'b', col = 'blue')\nlines(x = data_line$Time[37:48], y = data_line$weight[37:48], type = 'b', col = 'orange')\nlegend(0, 250, legend=c( \"Diet A\", \"Diet B\", \"Diet C\", \"Diet D\"),\n       col = c('red', 'green3', 'blue', 'orange'), pch = 21)\n\n\n\n\n\n\n6.1.2 ggplot2\nDo narysowania wykresu liniowego wykorzystaj funkcje ggplot i geom_line.\nW funkcji ggplot podaj nazwę tabeli i nazwę kolumn z danymi: ggplot(nazwa_tabeli, aes(x = nazwa_kolumny_1, y = nazwa_kolumny_2)). Potem dodaj geom_line(). W aes możesz też podać trzecią kolumnę, która pozwoli na pokolorowanie linii według zmiennej jakościowej. Legenda zostanie utworzona automatycznie.\n\n# wczytanie biblioteki\nlibrary(ggplot2)\n\n# zmienna Diet jest liczbą, więc musimy najpierw zmienić ją na zmienną tekstową\ndata_line$Diet &lt;- as.character(data_line$Diet)\n\nggplot(data_line, aes(x = Time, y = weight, color = Diet))+\n  geom_line()+\n  theme_bw()\n\n\n\n# Do wykresu możesz dodać punkty pokazujące obserwacje\nggplot(data_line, aes(x = Time, y = weight, color = Diet))+\n  geom_line()+\n  geom_point()+\n  theme_bw()"
  },
  {
    "objectID": "line_plot.html#jak-narysować-wykres-liniowy-w-excel",
    "href": "line_plot.html#jak-narysować-wykres-liniowy-w-excel",
    "title": "6  Wykres liniowy",
    "section": "6.2 Jak narysować wykres liniowy w Excel?",
    "text": "6.2 Jak narysować wykres liniowy w Excel?\nAby narysować wykres liniowy w programie Excel zaznacz dane w arkuszu, a następnie wybierz wykres 2-D Line z zakładki Insert. Jeżeli chcesz, aby na wykresie znalazły się linie w różnych kolorach zaznacz kilka kolumn.\n\n\n\n\n\nOtrzymany wykres powinien wyglądać podobnie do przykładu poniżej. Dane użyte do przygotowania poniższego wykresu wymagały zmiany z formatu wąskiego na szeroki. Jak to zrobić w Excel sprawdź Tabela przestawna"
  },
  {
    "objectID": "error_bar.html#jak-dodać-słupek-błędu-w-r",
    "href": "error_bar.html#jak-dodać-słupek-błędu-w-r",
    "title": "7  Słupki błędów",
    "section": "7.1 Jak dodać słupek błędu w R",
    "text": "7.1 Jak dodać słupek błędu w R\nDodanie słupków błędu w podstawowym R jest możliwe przy pomocy funkcji arrows, ale dość niewygodne, więc w przykładzie znajdzie się tylko pakiet ggplot2.\nAby dodać słupki błędu do wykresu trzeba najpierw policzyć średnią i odchylenie standardowe dla wszystkich grup zawartych w danych. W przykładzie wykorzystam dane dotyczące wpływu witaminy C na wzrost zębów u świnek morskich.\nŻeby dodać słupek błędu do wykresu można użyć funkcji geom_errorbar lub geom_linerange.\n\n# wczytanie danych\ndata_tooth &lt;- read.table('data/tooth.txt')\nhead(data_tooth)\n\n   len supp dose\n1  4.2   VC  0.5\n2 11.5   VC  0.5\n3  7.3   VC  0.5\n4  5.8   VC  0.5\n5  6.4   VC  0.5\n6 10.0   VC  0.5\n\n# obliczenie średniej długości zęba w zależności od suplementu i dawki\n# pakiet dplyr umożliwia łatwe manipulacje danymi tabelarycznymi\n# możesz też średnią i odchylenie obliczyć np. w Excel i do R wczytać gotowe dane\nlibrary(dplyr)\n# najpierw podział na grupy\ndata_tooth &lt;- group_by(data_tooth, supp, dose)\n# Obliczenie średniej i odchylenia standardowego\ndata_tooth_summary &lt;- summarise(data_tooth, srednia = mean(len),\n                                odchylenie = sd(len))\n# wynik\ndata_tooth_summary\n\n# A tibble: 6 × 4\n# Groups:   supp [2]\n  supp   dose srednia odchylenie\n  &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;\n1 OJ      0.5   13.2        4.46\n2 OJ      1     22.7        3.91\n3 OJ      2     26.1        2.66\n4 VC      0.5    7.98       2.75\n5 VC      1     16.8        2.52\n6 VC      2     26.1        4.80\n\n# zmiana typu zmiennej dose na tekstowy\ndata_tooth_summary$dose &lt;- as.character(data_tooth_summary$dose)\n\nlibrary(ggplot2)\n\n# wykres słupkowy\nggplot(data_tooth_summary, aes(x = supp, y = srednia, fill = dose))+\n  geom_col(position = 'dodge')+ # wykres słupkowy\n  geom_linerange(aes(ymin = srednia - odchylenie, ymax = srednia + odchylenie), # słupki błędu\n                 position = position_dodge(width = 0.9))+ # position żeby pasowały do słupków\n  theme_bw() # białe tło\n\n\n\n\nDane tego typu lepiej przedstawić w formie punktów pokazujących wszystkie obserwacje i do tego dodać średnią z przedziałem ufności. Można do tego wykorzystać funkcję stat_summary. Wtedy możemy pominąć etap obliczania średniej z wykorzystaniem pakietu dplyr.\n\n# zmiana typu zmiennej dose na tekstowy\ndata_tooth$dose &lt;- as.character(data_tooth$dose)\n\nggplot(data_tooth, aes(x = supp, y = len, color = dose, group = dose))+\n  geom_point(position = position_dodge(width = 0.9))+\n  theme_bw()+\n  stat_summary(fun.data = 'mean_cl_normal', # przedział ufności\n               geom = 'pointrange', # co narysować\n               position = position_dodge(width = 0.9), # odpowiednia pozycja\n               color = 'black') # czarny kolor\n\n\n\n# albo\n\nggplot(data_tooth, aes(x = supp, y = len, color = dose, group = dose))+\n  geom_point(position = position_dodge(width = 0.9))+\n  theme_bw()+\n  stat_summary(fun.data = 'mean_cl_normal', geom = 'crossbar', # przedział ufności\n               position = position_dodge(width = 0.9))"
  },
  {
    "objectID": "error_bar.html#jak-dodać-słupek-błędu-w-excel",
    "href": "error_bar.html#jak-dodać-słupek-błędu-w-excel",
    "title": "7  Słupki błędów",
    "section": "7.2 Jak dodać słupek błędu w Excel",
    "text": "7.2 Jak dodać słupek błędu w Excel\nPodobnie jak w przykładzie dotyczącym R pierwszym krokiem będzie obliczenie średniej i idchylenia standardowego. Można to zrobić ręcznie korzystając z formuł Excela albo skorzystać z tabeli przestawnej, co w przypadku dużych danych będzie znacznie szybsze. Poniżej przykładowe ustawienie opcji tabeli przestawnej i wynik.\n \nSłupki blędu można dodać do wykresu słupkowego lub punktowego. W prawym górnym rogu wykresu można otworzyć menu pozwalające na dodanie do wykresu m. in. legendy i słupków błędu. Po dodaniu słupki błędu domyślnie mają taką samą długość i wymagają zmiany. Trzeba ręcznie wybrać zakres danych, który zawiera wartości obliczonego odchylenia standardowego. W opcjach słupków błędu wybieramy Custom i następnie Specify Value.\n\n\n\n\n\nOtrzymany wykres powinien wyglądać podobnie do przykładu poniżej.\n\n\n\n\n\nW Excelu można też narysować wykres pokazujący wszystkie obserwacje wraz z średnią i odchyleniem standardowym w formie słupka błędu. Wymaga to ręcznego ustawienia serii danych osobno dla punktów i dla słupka błędu. Poniżej przykład takiego wykresu, w którym przesunęłam słupek błędu w prawo tak aby nie zasłaniał punktów."
  },
  {
    "objectID": "tstudent.html#jak-wykonać-test-t-studenta-w-r",
    "href": "tstudent.html#jak-wykonać-test-t-studenta-w-r",
    "title": "8  Test t-studenta",
    "section": "8.1 Jak wykonać test t-studenta w R?",
    "text": "8.1 Jak wykonać test t-studenta w R?\nDo wykonania testu t-studenta można wykorzystać funkcję t.test. Jako dwa pierwsze argumenty funkcji wpisujemy dwie kolumny tabeli (dane uporządkowane w sposób szeroki) np.t.test(dane$kolumna_1, dane$kolumna2) albo używamy formuły (dane uporządkowane w sposób wąski) np. t.test(kolumna_1 ~ kolumna_2, data = dane).\nWynik funkcji zawiera m.in. wartość p, która pokazuje prawdopodobieństwo, że obserwowane różnice są wynikiem losowego układu danych, wartość statystyki testowej T i średnie obu grup.\nTestu t-studenta nie powinno się używać do analizy średnich więcej niż dwóch grup bez przeprowadzenia korekcji wielokrotnych powtórzeń np. przy pomocy metody Bonferroniego. W R można znaleźć funkcję pairwise.t.test, która wykona test t-studenta pomiędzy wszystkimi grupami obecnymi w danych, biorąc pod uwagę wielokrotne powtórzenia tego samego testu.\n\n# wczytanie danych\ndane_t_waskie &lt;- read.table('data/data_t_long.txt')\ndane_t_szerokie &lt;- read.table('data/data_t_wide.txt')\n\n# dane szerokie\nt.test(dane_t_szerokie$A, dane_t_szerokie$B)\n\n\n    Welch Two Sample t-test\n\ndata:  dane_t_szerokie$A and dane_t_szerokie$B\nt = -12.386, df = 35.927, p-value = 1.578e-14\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -4.729385 -3.398398\nsample estimates:\nmean of x mean of y \n  9.81245  13.87634 \n\n# dane wąskie\nt.test(x ~ y, data = dane_t_waskie)\n\n\n    Welch Two Sample t-test\n\ndata:  x by y\nt = -12.386, df = 35.927, p-value = 1.578e-14\nalternative hypothesis: true difference in means between group A and group B is not equal to 0\n95 percent confidence interval:\n -4.729385 -3.398398\nsample estimates:\nmean in group A mean in group B \n        9.81245        13.87634"
  },
  {
    "objectID": "tstudent.html#jak-wykonać-test-t-studenta-w-excel",
    "href": "tstudent.html#jak-wykonać-test-t-studenta-w-excel",
    "title": "8  Test t-studenta",
    "section": "8.2 Jak wykonać test t-studenta w Excel?",
    "text": "8.2 Jak wykonać test t-studenta w Excel?\nDo przeprowadzenia testu t-studenta można użyć funkcji TEST.T. Funkcja do działania potrzebuje czeterech argumentów: TEST.T(tablica1;tablica2;strony;typ). Tablica1 i 2 to zakres danych, strony podajemy 2 żeby wykonać test dwustronny, typ najlepiej 3 czyli test dla dwóch grup o nierównej wariancji. Jako wynik dodstaniemy wartość p dla testu."
  }
]